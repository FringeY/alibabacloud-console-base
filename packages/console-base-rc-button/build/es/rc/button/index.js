import _defineProperty from "@babel/runtime/helpers/esm/defineProperty";
import _objectWithoutProperties from "@babel/runtime/helpers/esm/objectWithoutProperties";
import _slicedToArray from "@babel/runtime/helpers/esm/slicedToArray";
import _taggedTemplateLiteral from "@babel/runtime/helpers/esm/taggedTemplateLiteral";

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _templateObject24() {
  var data = _taggedTemplateLiteral(["\n  flex: 1;\n  ", ";\n"]);

  _templateObject24 = function _templateObject24() {
    return data;
  };

  return data;
}

function _templateObject23() {
  var data = _taggedTemplateLiteral(["\n  margin: 0 8px 0 4px;\n  \n  &:first-child {\n    margin-left: 0;\n  }\n  \n  &:last-child {\n    margin-right: 0;\n  }\n"]);

  _templateObject23 = function _templateObject23() {
    return data;
  };

  return data;
}

function _templateObject22() {
  var data = _taggedTemplateLiteral(["\n  display: flex;\n  align-items: center;\n"]);

  _templateObject22 = function _templateObject22() {
    return data;
  };

  return data;
}

function _templateObject21() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n  ", ";\n"]);

  _templateObject21 = function _templateObject21() {
    return data;
  };

  return data;
}

function _templateObject20() {
  var data = _taggedTemplateLiteral(["\n      &:hover,\n      &:link:hover,\n      &:visited:hover {\n        color: ", ";\n      }\n    "]);

  _templateObject20 = function _templateObject20() {
    return data;
  };

  return data;
}

function _templateObject19() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject19 = function _templateObject19() {
    return data;
  };

  return data;
}

function _templateObject18() {
  var data = _taggedTemplateLiteral(["\n      &,\n      &:link,\n      &:visited,\n      &:hover {\n        color: ", ";\n      }\n    "]);

  _templateObject18 = function _templateObject18() {
    return data;
  };

  return data;
}

function _templateObject17() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject17 = function _templateObject17() {
    return data;
  };

  return data;
}

function _templateObject16() {
  var data = _taggedTemplateLiteral(["\n      &:hover {\n        background-color: ", ";\n      }\n    "]);

  _templateObject16 = function _templateObject16() {
    return data;
  };

  return data;
}

function _templateObject15() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject15 = function _templateObject15() {
    return data;
  };

  return data;
}

function _templateObject14() {
  var data = _taggedTemplateLiteral(["\n      background-color: ", ";\n    "]);

  _templateObject14 = function _templateObject14() {
    return data;
  };

  return data;
}

function _templateObject13() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function _templateObject12() {
  var data = _taggedTemplateLiteral(["\n      &:hover {\n        border-color: ", ";\n      }\n    "]);

  _templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function _templateObject11() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function _templateObject10() {
  var data = _taggedTemplateLiteral(["\n      border-color: ", ";\n    "]);

  _templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function _templateObject9() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function _templateObject8() {
  var data = _taggedTemplateLiteral(["\n        font-size: ", "px;\n      "]);

  _templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function _templateObject7() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function _templateObject6() {
  var data = _taggedTemplateLiteral(["\n        padding: 0 ", "px;\n        height: ", "px;\n        line-height: ", "px;\n      "]);

  _templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function _templateObject5() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function _templateObject4() {
  var data = _taggedTemplateLiteral(["\n    white-space: nowrap;\n  "]);

  _templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function _templateObject3() {
  var data = _taggedTemplateLiteral(["\n  ", ";\n"]);

  _templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function _templateObject2() {
  var data = _taggedTemplateLiteral(["\n  display: block;\n  width: 100%;\n"]);

  _templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function _templateObject() {
  var data = _taggedTemplateLiteral(["\n  display: inline-block;\n  border: ", ";\n  overflow: hidden;\n  vertical-align: middle;\n  text-align: ", ";\n  color: ", ";\n"]);

  _templateObject = function _templateObject() {
    return data;
  };

  return data;
}

import React, { forwardRef } from 'react';
import styled, { css } from 'styled-components';
import { COLOR, button, typo } from '@alicloud/console-base-styled-mixin';
import Icon from '@alicloud/console-base-rc-icon';
import { EButtonSize } from '../../const';
import getSizes from '../../util/get-sizes';
import getFontSize from '../../util/get-font-size';
import getColor from '../../util/get-color';
import getColorBg from '../../util/get-color-bg';
import getColorBd from '../../util/get-color-bd';
import getPreset from '../../util/get-preset'; // 按钮通用样式，没有 Size 的时候不设边框

var cssCommon = css(_templateObject(), function (props) {
  return props.size === EButtonSize.NONE ? 'none' : '1px solid transparent';
}, function (props) {
  return props.textAlign || 'center';
}, COLOR.TEXT_SECONDARY);
var cssBlock = css(_templateObject2());
var cssEllipsis = css(_templateObject3(), function (props) {
  return props.ellipsis ? typo.ellipsis : css(_templateObject4());
}); // 按钮大小 - 仅高度和 padding，不考虑文字

var cssSize = css(_templateObject5(), function (props) {
  var value = getSizes(props.size);

  if (value) {
    var _value = _slicedToArray(value, 3),
        pd = _value[0],
        h = _value[1],
        lh = _value[2];

    return css(_templateObject6(), pd, h, lh);
  }
});
var cssFontSize = css(_templateObject7(), function (props) {
  var value = getFontSize(props.fontSize);

  if (value > 0) {
    return css(_templateObject8(), value);
  }
});
var cssColorBd = css(_templateObject9(), function (props) {
  var value = getColorBd(props.themeColorBd);
  return value ? css(_templateObject10(), value) : null;
});
var cssColorBdHover = css(_templateObject11(), function (_ref) {
  var disabled = _ref.disabled,
      themeColorBdHover = _ref.themeColorBdHover;

  if (disabled) {
    return;
  }

  var value = getColorBd(themeColorBdHover);
  return value ? css(_templateObject12(), value) : null;
});
var cssColorBg = css(_templateObject13(), function (props) {
  var value = getColorBg(props.themeColorBg);
  return value ? css(_templateObject14(), value) : null;
});
var cssColorBgHover = css(_templateObject15(), function (_ref2) {
  var disabled = _ref2.disabled,
      themeColorBgHover = _ref2.themeColorBgHover;

  if (disabled) {
    return;
  }

  var value = getColorBg(themeColorBgHover);
  return value ? css(_templateObject16(), value) : null;
});
var cssColor = css(_templateObject17(), function (_ref3) {
  var disabled = _ref3.disabled,
      themeColor = _ref3.themeColor;

  if (disabled) {
    return;
  }

  var value = getColor(themeColor);
  return value ? css(_templateObject18(), value) : null;
});
var cssColorHover = css(_templateObject19(), function (props) {
  if (props.disabled) {
    return;
  }

  var value = getColor(props.themeColorHover);
  return value ? css(_templateObject20(), value) : null;
});
var ScButton = styled.span(_templateObject21(), button.reset, cssCommon, function (props) {
  return props.block ? cssBlock : null;
}, cssEllipsis, cssSize, cssFontSize, cssColorBd, cssColorBdHover, cssColorBg, cssColorBgHover, cssColor, cssColorHover); // 当有 iconLeft iconRight loading 时对内容的包裹

var ScInner = styled.span(_templateObject22());
var ScInnerIcon = styled.span(_templateObject23());
var ScInnerLabel = styled.span(_templateObject24(), typo.ellipsis);

function getTarget(href, target) {
  if (target) {
    return target;
  }

  if (/^(?:https?:)?\/\//.test(href)) {
    // 且认为只要是绝对地址就应该是 _blank 一般不会有人傻到写自己站点的绝对地址
    return '_blank';
  }
}

function renderIcon(icon) {
  if (!icon) {
    return null;
  }

  if ( /*#__PURE__*/React.isValidElement(icon)) {
    return icon;
  }

  return /*#__PURE__*/React.createElement(Icon, {
    type: icon
  });
}

function Button(_ref4, ref) {
  var _ref4$component = _ref4.component,
      component = _ref4$component === void 0 ? 'button' : _ref4$component,
      label = _ref4.label,
      title = _ref4.title,
      iconLeft = _ref4.iconLeft,
      iconRight = _ref4.iconRight,
      children = _ref4.children,
      href = _ref4.href,
      target = _ref4.target,
      spm = _ref4.spm,
      _ref4$size = _ref4.size,
      size = _ref4$size === void 0 ? EButtonSize.M : _ref4$size,
      loading = _ref4.loading,
      disabled = _ref4.disabled,
      preset = _ref4.preset,
      restProps = _objectWithoutProperties(_ref4, ["component", "label", "title", "iconLeft", "iconRight", "children", "href", "target", "spm", "size", "loading", "disabled", "preset"]);

  var propsForSc = _objectSpread(_objectSpread({
    size: size,
    disabled: disabled
  }, getPreset(preset, disabled)), restProps);

  var jsxIconLeft = loading ? /*#__PURE__*/React.createElement(Icon, {
    type: "loading"
  }) : renderIcon(iconLeft);
  var jsxIconRight = renderIcon(iconRight);
  var as = component;
  var jsxInner = label || children; // label prior to children
  // loading 的时候没有 hover 样式，cursor 在非 disabled 状态下为箭头

  if (loading) {
    delete propsForSc.themeColorBdHover;
    delete propsForSc.themeColorBgHover;
    delete propsForSc.themeColorHover;

    if (!disabled) {
      propsForSc.style = _objectSpread(_objectSpread({}, propsForSc.style), {}, {
        cursor: 'default'
      });
    }
  } // loading 或 disabled 状态下对点击失效


  if (disabled || loading) {
    delete propsForSc.onClick;
  }

  if (title) {
    if (typeof title === 'string') {
      propsForSc.title = title;
    } else if (label && typeof label === 'string') {
      // title === true
      propsForSc.title = label;
    }
  }

  if (jsxIconLeft || jsxIconRight) {
    jsxInner = /*#__PURE__*/React.createElement(ScInner, null, jsxIconLeft ? /*#__PURE__*/React.createElement(ScInnerIcon, null, jsxIconLeft) : null, jsxInner ? /*#__PURE__*/React.createElement(ScInnerLabel, null, jsxInner) : null, jsxIconRight ? /*#__PURE__*/React.createElement(ScInnerIcon, null, jsxIconRight) : null);
  }

  if (href && !disabled) {
    as = 'a'; // 保证有 href 且非 disabled 状态下一定是 a

    propsForSc.href = href;
    propsForSc.target = getTarget(href, target);
  }

  return /*#__PURE__*/React.createElement(ScButton, _objectSpread(_objectSpread({
    ref: ref,
    as: as
  }, propsForSc), {}, {
    'data-spm-click': "gostr=/aliyun;locaid=d".concat(spm)
  }), jsxInner);
}

export default /*#__PURE__*/forwardRef(Button);